# 配置iOS快捷指令详细步骤

本文档提供了如何配置iOS快捷指令以调用小红书内容提取API的详细步骤。

## 前提条件

1. 确保API服务器已经运行（可通过 `python run_server.py start` 启动）
2. 获取服务器IP地址（可通过 `python run_server.py get-ip` 查看）
3. 确保iPhone/iPad与服务器在同一WiFi网络下

## 创建快捷指令步骤

1. **打开"快捷指令"应用**

2. **创建新的快捷指令**
   - 点击右上角的 "+" 按钮
   - 给快捷指令命名，如"小红书内容保存"

3. **添加获取剪贴板操作**
   - 搜索并添加"获取剪贴板"操作
   - 这将获取你复制的小红书链接

4. **添加获取网页内容操作**
   - 搜索并添加"获取网页内容"操作
   - URL 设置为 `http://你的服务器IP:8000/extract`
   - 方法选择 `POST`
   - 请求正文设置为 `{"url": "剪贴板内容"}`
   - 添加一个名为 `Content-Type` 的请求头，值为 `application/json`

5. **添加获取词典值操作**
   - 搜索并添加"获取词典值"操作
   - 从 "获取网页内容" 的结果中获取所需的数据
   - 需要获取的键包括：`title`, `description`, `images`, `original_url`

6. **创建备忘录**
   - 搜索并添加"创建备忘录"操作
   - 标题设置为从API获取的 `title` 值
   - 正文开始部分设置为从API获取的 `description` 值
   - 添加原始链接，格式为 `原始链接: {获取的original_url}`

7. **处理图片（可选两种方案）**

   **方案A: 直接使用Base64图片**
   - 添加"对列表重复"操作，对获取的 `images` 列表进行循环
   - 在循环内，获取每个图片的 `base64` 值
   - 添加"从Base64解码"操作
   - 添加"添加到备忘录"操作，将解码的图片添加到之前创建的备忘录中

   **方案B: 保存图片到相册后添加**
   - 添加"对列表重复"操作，对获取的 `images` 列表进行循环
   - 在循环内，获取每个图片的 `url` 值
   - 添加"获取网页内容"操作获取图片
   - 添加"保存到相册"操作
   - 添加"从最近的照片中获取"操作
   - 添加"添加到备忘录"操作，将图片添加到之前创建的备忘录中

8. **添加通知（可选）**
   - 添加"显示通知"操作
   - 内容设置为"小红书内容已保存到备忘录"

9. **保存快捷指令**
   - 点击右上角的"完成"按钮保存快捷指令

## 使用方法

1. 在小红书应用中找到你想保存的内容
2. 点击分享按钮，选择"复制链接"
3. 运行你创建的"小红书内容保存"快捷指令
4. 等待几秒钟，内容和图片将被保存到备忘录中

## 故障排除

- **API连接失败**: 确保服务器正在运行，且手机和服务器在同一网络中
- **无法解析内容**: 确保复制的是完整的小红书链接
- **图片无法显示**: 检查API返回的图片格式，可能需要调整解码方式

## 示例JSON响应格式

以下是API返回的JSON数据示例，供参考构建快捷指令：

```json
{
  "type": "图文",
  "title": "小红书帖子标题",
  "description": "这是帖子的详细描述...",
  "images": [
    {
      "url": "https://example.com/image1.jpg",
      "base64": "base64编码的图片内容...",
      "extension": ".jpg"
    }
  ],
  "original_url": "https://www.xiaohongshu.com/..."
}
``` 